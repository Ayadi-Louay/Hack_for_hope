# ğŸ”„ WORKFLOW DÃ‰TAILLÃ‰ - Hack for Hope

## ğŸ“‹ Vue d'ensemble des 3 niveaux

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ NIVEAU 1 : DÃ‰CLARANTS (Terrain)                                â”‚
â”‚ RÃ´les : MÃ¨res SOS, Tantes SOS, Ã‰ducateurs                      â”‚
â”‚ Village : AssignÃ© Ã  un village spÃ©cifique                      â”‚
â”‚ Action : CrÃ©er un signalement (anonyme ou non)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â†“ Signalement crÃ©Ã©
                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ NIVEAU 2 : ANALYSTES (Traitement)                              â”‚
â”‚ RÃ´les : Psychologues, Responsables Sociaux                     â”‚
â”‚ Village : AssignÃ© Ã  un village spÃ©cifique                      â”‚
â”‚ Action : CLASSIFIER puis traiter selon classification          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â†“ CLASSIFICATION (choix obligatoire)
                   â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚          â”‚          â”‚
    â”Œâ”€â”€â”€â–¼â”€â”€â”€â”  â”Œâ”€â”€â–¼â”€â”€â”  â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”
    â”‚ FAUX  â”‚  â”‚ P.E.Câ”‚  â”‚SAUVEG. â”‚
    â””â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”¬â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
        â”‚         â”‚          â”‚
        â”‚         â”‚          â””â”€â”€â”€â”€â–º PROCÃ‰DURE OBLIGATOIRE (6 Ã©tapes)
        â”‚         â”‚                 â”œâ”€ 1. Fiche initiale + DPE
        â”‚         â”‚                 â”œâ”€ 2. Ã‰valuation complÃ¨te
        â”‚         â””â”€â”€â”€â”€â–º Simple     â”œâ”€ 3. Plan d'action
        â”‚                traitement â”œâ”€ 4. Rapport de suivi
        â”‚                           â”œâ”€ 5. Rapport final
        â””â”€â”€â”€â”€â–º ClÃ´ture              â””â”€ 6. Avis de clÃ´ture
               immÃ©diate                 â”‚
                                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ NIVEAU 3 : DIRECTION (DÃ©cision finale)                         â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ Directeur National â†’ Voit TOUS les villages               â”‚ â”‚
â”‚ â”‚ (Gammarth, Siliana, Mahres, Akouda)                       â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ 4 Directeurs Village â†’ Chacun voit SON village uniquement â”‚ â”‚
â”‚ â”‚ (Supervision, pas de classification ni checklist)         â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ Action : DÃ©cision formelle + Archivage sÃ©curisÃ©                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¢ Architecture SOS Villages

### **4 Villages d'Enfants SOS en Tunisie** :
1. **Village Gammarth** (Nord)
2. **Village Siliana** (Nord-Ouest)
3. **Village Mahres** (Centre-Est)
4. **Village Akouda** (Centre-Est)

### **Structure hiÃ©rarchique** :

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Directeur National     â”‚
                    â”‚  (Bureau National)      â”‚
                    â”‚  Voit: TOUS les villagesâ”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                  â”‚                  â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
    â”‚ Dir. Gammarthâ”‚  â”‚ Dir. Siliana â”‚  â”‚ Dir. Mahres  â”‚ ...
    â”‚ (Niveau 3)   â”‚  â”‚ (Niveau 3)   â”‚  â”‚ (Niveau 3)   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
            â”‚                  â”‚                  â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
    â”‚           Psychologues / Responsables Sociaux      â”‚
    â”‚                    (Niveau 2)                      â”‚
    â”‚         AssignÃ©s Ã  un village spÃ©cifique           â”‚
    â”‚    Classification + Checklist + Traitement         â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚    DÃ©clarants : MÃ¨res, Tantes, Ã‰ducateurs       â”‚
    â”‚              (Niveau 1)                         â”‚
    â”‚      AssignÃ©s Ã  un village spÃ©cifique           â”‚
    â”‚          CrÃ©ent les signalements                â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ NIVEAU 1 : CrÃ©ation du signalement

### Qui ?
- MÃ¨res SOS
- Tantes SOS
- Ã‰ducateurs/Ã‰ducatrices

### Actions possibles :
1. **Remplir le formulaire de signalement** :
   - Anonyme OU identifiÃ©
   - Type d'incident (Maltraitance, SantÃ©, Comportement, Conflit, Autre)
   - Niveau d'urgence (Faible, Moyen, Ã‰levÃ©, Critique)
   - Village concernÃ©
   - Nom de l'abuseur (optionnel)
   - Nom de l'enfant concernÃ© (optionnel)
   - Description dÃ©taillÃ©e
   
2. **Uploader des piÃ¨ces jointes** (optionnel) :
   - Photos
   - Enregistrements audio
   - VidÃ©os

3. **Soumettre le signalement**
   â†’ EnvoyÃ© aux psychologues/directeurs de village du mÃªme village

### Statut initial :
- `status` = `EN_ATTENTE`
- `classification` = `NON_CLASSIFIE`

---

## ğŸ¯ NIVEAU 2 : Classification et Traitement

### Qui ?
- **Psychologues** (assignÃ©s Ã  un village)
- **Responsables Sociaux** (assignÃ©s Ã  un village)

**âš ï¸ Important** : Les Directeurs Village sont au **Niveau 3**, ils ne font PAS la classification ni la checklist.
- Directeurs de village

### Ã‰tape 1 : CLASSIFIER le signalement (choix obligatoire)

Le psychologue/directeur doit **choisir une classification** :

#### Option A : FAUX âŒ
**Signification** : Fausse alerte, aucun danger rÃ©el

**Actions** :
1. Marquer `classification` = `FAUX`
2. Ajouter un commentaire de justification
3. Changer `status` = `FAUX`
4. **ClÃ´ture immÃ©diate** du dossier

**Pas de procÃ©dure, fin du workflow**

---

#### Option B : PRISE EN CHARGE âš•ï¸
**Signification** : Cas lÃ©ger, problÃ¨me pas dangereux, traitement simple

**Actions** :
1. Marquer `classification` = `PRISE_EN_CHARGE`
2. Changer `status` = `PRISE_EN_CHARGE`
3. **Traitement simple** :
   - Suivi psychologique rÃ©gulier
   - Actions correctives simples
   - Rapports libres (pas de checklist obligatoire)
4. Quand terminÃ© â†’ `status` = `CLOTURE`

**Pas de procÃ©dure obligatoire, workflow flexible**

---

#### Option C : SAUVEGARDE ğŸš¨ (LE PLUS IMPORTANT)
**Signification** : **Cas grave**, danger rÃ©el, nÃ©cessite une procÃ©dure stricte

**Actions** :
1. Marquer `classification` = `SAUVEGARDE`
2. Changer `status` = `EN_PROCEDURE`
3. **DÃ‰CLENCHE LA PROCÃ‰DURE OBLIGATOIRE** (checklist 6 Ã©tapes)

---

### ğŸ”¥ LA PROCÃ‰DURE (si classification = SAUVEGARDE)

**Principe** : Checklist **BLOQUANTE** â†’ on ne peut pas passer Ã  l'Ã©tape suivante sans complÃ©ter l'Ã©tape prÃ©cÃ©dente

#### **Ã‰tape 1 : Fiche initiale + Rapport DPE** ğŸ“„
**Objectif** : Documentation initiale + notification hiÃ©rarchique

**Actions** :
1. TÃ©lÃ©charger le template Word : `etape1_fiche_initiale_dpe.docx`
2. Remplir :
   - Fiche de signalement dÃ©taillÃ©e
   - Rapport pour le Directeur Programme Enfance (DPE)
   - Notification au Bureau National
3. Uploader le(s) document(s) rempli(s)
4. Valider l'Ã©tape â†’ `procedure_progress.step_1.is_completed` = TRUE

**Bloquage** : Ã‰tape 2 impossible tant que Ã‰tape 1 non complÃ©tÃ©e

---

#### **Ã‰tape 2 : Ã‰valuation complÃ¨te** ğŸ”
**Objectif** : Ã‰valuation approfondie par le psychologue

**Actions** :
1. TÃ©lÃ©charger le template : `etape2_evaluation_complete.docx`
2. Remplir :
   - Ã‰valuation psychologique de l'enfant
   - Ã‰valuation de l'environnement
   - Analyse des risques
   - Recommandations
3. Uploader le document rempli
4. Valider l'Ã©tape

**Bloquage** : Ã‰tape 3 impossible tant que Ã‰tape 2 non complÃ©tÃ©e

---

#### **Ã‰tape 3 : Plan d'action** ğŸ“‹
**Objectif** : DÃ©finir les mesures concrÃ¨tes Ã  prendre

**Actions** :
1. TÃ©lÃ©charger le template : `etape3_plan_action.docx`
2. Remplir :
   - Actions immÃ©diates Ã  prendre
   - Responsables de chaque action
   - DÃ©lais
   - Ressources nÃ©cessaires
3. Uploader le document rempli
4. Valider l'Ã©tape

**Bloquage** : Ã‰tape 4 impossible tant que Ã‰tape 3 non complÃ©tÃ©e

---

#### **Ã‰tape 4 : Rapport de suivi** ğŸ“Š
**Objectif** : Suivi rÃ©gulier de l'Ã©volution

**Actions** :
1. TÃ©lÃ©charger le template : `etape4_rapport_suivi.docx`
2. Remplir (peut Ãªtre fait plusieurs fois) :
   - Ã‰tat d'avancement des actions
   - Ã‰volution de la situation de l'enfant
   - Obstacles rencontrÃ©s
   - Ajustements nÃ©cessaires
3. Uploader le(s) rapport(s) de suivi
4. Valider l'Ã©tape

**Bloquage** : Ã‰tape 5 impossible tant que Ã‰tape 4 non complÃ©tÃ©e

---

#### **Ã‰tape 5 : Rapport final** ğŸ“
**Objectif** : Bilan final de la prise en charge

**Actions** :
1. TÃ©lÃ©charger le template : `etape5_rapport_final.docx`
2. Remplir :
   - SynthÃ¨se de toutes les actions menÃ©es
   - RÃ©sultats obtenus
   - Ã‰tat final de l'enfant
   - Recommandations pour la suite
3. Uploader le document rempli
4. Valider l'Ã©tape

**Bloquage** : Ã‰tape 6 impossible tant que Ã‰tape 5 non complÃ©tÃ©e

---

#### **Ã‰tape 6 : Avis de clÃ´ture** âœ…
**Objectif** : Validation finale de la clÃ´ture du dossier

**Actions** :
1. TÃ©lÃ©charger le template : `etape6_avis_cloture.docx`
2. Remplir :
   - Validation que tous les objectifs sont atteints
   - Accord pour clÃ´turer le dossier
   - Signature(s) des responsables
3. Uploader le document rempli
4. Valider l'Ã©tape

**RÃ©sultat** : Toutes les 6 Ã©tapes complÃ©tÃ©es â†’ Dossier prÃªt pour la Direction

---

### FonctionnalitÃ©s supplÃ©mentaires Niveau 2 :

#### Tableau de bord de gestion
- Liste de tous les signalements reÃ§us
- Filtres :
  - Par statut (EN_ATTENTE, PRISE_EN_CHARGE, EN_PROCEDURE, etc.)
  - Par classification (FAUX, PRISE_EN_CHARGE, SAUVEGARDE)
  - Par village
  - Par urgence
  - Par date
- Vue de la progression de la procÃ©dure (pour les cas SAUVEGARDE)

#### Notifications temps rÃ©el
- Nouveau signalement reÃ§u
- Signalement urgent (urgence = CRITIQUE)
- Rappel : Ã©tape de procÃ©dure en attente depuis X jours
- Escalade vers la Direction

#### RÃ©daction de rapports confidentiels
- Tous les documents de la procÃ©dure sont confidentiels
- AccÃ¨s restreint selon le rÃ´le
- Chiffrement des documents sensibles
- Logs d'accÃ¨s (audit_logs)

---

## ğŸ¯ NIVEAU 3 : DÃ©cision finale et Archivage

### Qui ?
- Direction du village
- Bureau national

### Actions possibles :

1. **Vue globale par village** :
   - Dashboard avec tous les incidents du village
   - Statistiques (nombre par statut, par classification)
   - Alertes (cas critiques en attente)

2. **Prise de dÃ©cision formelle** :
   - Pour les cas SAUVEGARDE (procÃ©dure complÃ¨te) :
     - Consulter tous les documents de la procÃ©dure
     - Prendre une dÃ©cision finale :
       - Prise en charge continue
       - Sanction d'un Ã©ducateur/adulte
       - Suivi long terme
       - Autres mesures
   - Pour les cas PRISE_EN_CHARGE :
     - Validation de la clÃ´ture
     - DÃ©cisions complÃ©mentaires si nÃ©cessaire

3. **ClÃ´ture et archivage sÃ©curisÃ©** :
   - Changer `status` = `CLOTURE`
   - Archivage de tous les documents
   - Logs finaux (audit_logs)
   - Conservation sÃ©curisÃ©e (RGPD)

---

## ğŸ“Š SCHÃ‰MA DE BASE DE DONNÃ‰ES (CORRIGÃ‰)

### **8 tables principales** :

1. **users** : Utilisateurs (3 rÃ´les)
2. **incidents** : Signalements avec classification
3. **attachments** : PiÃ¨ces jointes (preuves + documents Word)
4. **status_history** : Historique des changements
5. **decisions** : DÃ©cisions formelles
6. **audit_logs** : TraÃ§abilitÃ© complÃ¨te
7. **procedure_templates** âœ¨ NOUVEAU : Templates Word pour la procÃ©dure
8. **procedure_progress** âœ¨ NOUVEAU : Tracking des Ã©tapes de la procÃ©dure

---

## ğŸ” RÃ¨gles de sÃ©curitÃ© (RBAC + RLS)

### **5 RÃ”LES utilisateurs** :
1. `DECLARANT` (Niveau 1)
2. `PSYCHOLOGUE` (Niveau 2)
3. `RESPONSABLE_SOCIAL` (Niveau 2)
4. `DIRECTEUR_VILLAGE` (Niveau 3)
5. `DIRECTEUR_NATIONAL` (Niveau 3)

---

### DECLARANT (Niveau 1)
**Village** : AssignÃ© Ã  un village spÃ©cifique

âœ… Peut :
- CrÃ©er un signalement dans son village
- Uploader des piÃ¨ces jointes (preuves)
- Voir **uniquement SES propres signalements**

âŒ Ne peut PAS :
- Voir les signalements des autres dÃ©clarants (mÃªme village)
- Classifier un signalement
- AccÃ©der Ã  la procÃ©dure
- Prendre des dÃ©cisions

---

### PSYCHOLOGUE (Niveau 2)
**Village** : AssignÃ© Ã  un village spÃ©cifique

âœ… Peut :
- Voir **tous les signalements de SON village uniquement**
- Classifier un signalement (FAUX / PRISE_EN_CHARGE / SAUVEGARDE)
- TÃ©lÃ©charger les templates de procÃ©dure
- Uploader les documents remplis (checklist 6 Ã©tapes)
- Marquer les Ã©tapes comme complÃ©tÃ©es
- CrÃ©er des dÃ©cisions

âŒ Ne peut PAS :
- Voir les signalements d'autres villages
- ClÃ´turer dÃ©finitivement un cas SAUVEGARDE sans accord Direction
- Modifier les signalements d'autres villages

---

### RESPONSABLE_SOCIAL (Niveau 2)
**Village** : AssignÃ© Ã  un village spÃ©cifique

âœ… Peut : (mÃªmes droits que PSYCHOLOGUE)
- Voir **tous les signalements de SON village uniquement**
- Classifier un signalement
- GÃ©rer la checklist procÃ©dure (6 Ã©tapes)
- CrÃ©er des dÃ©cisions

âŒ Ne peut PAS :
- Voir les signalements d'autres villages
- ClÃ´turer dÃ©finitivement un cas SAUVEGARDE sans accord Direction

---

### DIRECTEUR_VILLAGE (Niveau 3)
**Village** : AssignÃ© Ã  un village spÃ©cifique (Gammarth, Siliana, Mahres, ou Akouda)

âœ… Peut :
- Voir **tous les signalements de SON village uniquement**
- **Superviser le travail** des psychologues/responsables sociaux de son village
- AccÃ©der Ã  tous les documents de son village
- Prendre des dÃ©cisions finales pour son village
- ClÃ´turer les dossiers de son village
- Voir les statistiques de son village

âŒ Ne peut PAS :
- Voir les signalements des autres villages
- Classifier les signalements (rÃ´le des psychologues/responsables sociaux)
- Faire la checklist procÃ©dure (rÃ´le des psychologues/responsables sociaux)

**Note** : Le directeur village est en **supervision** uniquement. Il ne fait pas le travail opÃ©rationnel (classification/checklist).

---

### DIRECTEUR_NATIONAL (Niveau 3)
**Village** : NULL (voit tous les villages)

âœ… Peut : **(TOUS LES DROITS)**
- Voir **TOUS les signalements de TOUS les villages** (Gammarth, Siliana, Mahres, Akouda)
- AccÃ©der Ã  tous les documents
- Prendre des dÃ©cisions finales globales
- ClÃ´turer les dossiers
- Voir les statistiques nationales
- Superviser les 4 directeurs village
- AccÃ©der aux logs d'audit complets

âŒ Ne peut PAS :
- (Aucune restriction)

---

## ğŸ’¾ Exemples de donnÃ©es

### Incident en attente de classification
```json
{
  "id": "uuid-123",
  "declarant_id": "uuid-fatma",
  "type": "MALTRAITANCE",
  "urgence": "CRITIQUE",
  "village": "Village El Menzah",
  "description": "Suspicion de maltraitance...",
  "status": "EN_ATTENTE",
  "classification": "NON_CLASSIFIE"
}
```

### Incident classifiÃ© SAUVEGARDE (procÃ©dure en cours)
```json
{
  "id": "uuid-456",
  "declarant_id": null,  // Anonyme
  "type": "MALTRAITANCE",
  "urgence": "CRITIQUE",
  "village": "Village Sousse",
  "description": "Suspicion de maltraitance...",
  "status": "EN_PROCEDURE",
  "classification": "SAUVEGARDE",
  "classified_by": "uuid-ahmed",
  "classified_at": "2026-02-15T10:30:00Z",
  "analyste_id": "uuid-ahmed"
}
```

### Progression de la procÃ©dure
```json
{
  "incident_id": "uuid-456",
  "steps": [
    {"step_number": 1, "is_completed": true, "completed_at": "2026-02-15T14:00:00Z"},
    {"step_number": 2, "is_completed": true, "completed_at": "2026-02-16T09:00:00Z"},
    {"step_number": 3, "is_completed": false},  // Ã‰tape en cours
    {"step_number": 4, "is_completed": false},  // BloquÃ©e
    {"step_number": 5, "is_completed": false},  // BloquÃ©e
    {"step_number": 6, "is_completed": false}   // BloquÃ©e
  ]
}
```

---

## âœ… RÃ©sumÃ© des changements du setup

### Avant (incomplet) :
- âŒ Pas de classification
- âŒ Pas de procÃ©dure
- âŒ Pas de checklist
- âŒ Statuts incorrects

### AprÃ¨s (corrigÃ©) :
- âœ… Champ `classification` dans `incidents`
- âœ… Table `procedure_templates` (6 templates Word)
- âœ… Table `procedure_progress` (tracking des Ã©tapes)
- âœ… Statuts adaptÃ©s (EN_ATTENTE, FAUX, PRISE_EN_CHARGE, SAUVEGARDE, EN_PROCEDURE, CLOTURE)
- âœ… Table `attachments` amÃ©liorÃ©e (distingue preuves vs documents procÃ©dure)

---

## ğŸ¯ Pour le dÃ©veloppement

### Backend (Personne 2)
Routes Ã  crÃ©er :
- `POST /api/incidents/:id/classify` â†’ Classifier un incident
- `GET /api/procedure/templates` â†’ Liste des templates Word
- `GET /api/procedure/templates/:stepNumber/download` â†’ TÃ©lÃ©charger un template
- `POST /api/procedure/:incidentId/step/:stepNumber/complete` â†’ Marquer Ã©tape complÃ©tÃ©e
- `GET /api/procedure/:incidentId/progress` â†’ Voir la progression

### Frontend (Personne 3)
Pages Ã  crÃ©er :
- `/incidents/:id/classify` â†’ Formulaire de classification
- `/incidents/:id/procedure` â†’ Vue de la procÃ©dure (6 Ã©tapes)
- `/procedure/step/:stepNumber` â†’ DÃ©tail d'une Ã©tape (tÃ©lÃ©charger + uploader)
- `/dashboard/analyst` â†’ Dashboard analyste avec filtres

---

Workflow maintenant correct ! ğŸš€
